"""
Demo script for the Real-Time Video Analytics System
This script demonstrates the system structure and provides usage examples.
"""

import os
import sys

def print_system_info():
    """Print system information and structure"""
    print("ğŸ¯ Real-Time Video Analytics System")
    print("=" * 50)
    print()
    print("ğŸ“ Project Structure:")
    print("â”œâ”€â”€ src/")
    print("â”‚   â”œâ”€â”€ main.py           # Main processing pipeline")
    print("â”‚   â”œâ”€â”€ detect_track.py   # Person detection & tracking")
    print("â”‚   â”œâ”€â”€ face_crop.py      # Face detection & cropping")
    print("â”‚   â”œâ”€â”€ face_recog.py     # Face recognition & re-ID")
    print("â”‚   â”œâ”€â”€ utils.py          # Utility functions")
    print("â”‚   â””â”€â”€ config.py         # Configuration settings")
    print("â”œâ”€â”€ models/               # Model files (auto-downloaded)")
    print("â”œâ”€â”€ assets/")
    print("â”‚   â”œâ”€â”€ input_video.mp4   # Input video file")
    print("â”‚   â”œâ”€â”€ output_video.avi  # Processed output")
    print("â”‚   â””â”€â”€ faces/            # Cropped face images")
    print("â”œâ”€â”€ output/               # Additional outputs")
    print("â”œâ”€â”€ requirements.txt      # Python dependencies")
    print("â”œâ”€â”€ README.md             # Documentation")
    print("â”œâ”€â”€ test_installation.py  # Installation test")
    print("â””â”€â”€ demo.py               # This demo script")
    print()

def print_features():
    """Print system features"""
    print("ğŸš€ Key Features:")
    print("â€¢ Person Detection: YOLOv8 for accurate detection")
    print("â€¢ Person Tracking: ByteTracker for robust tracking")
    print("â€¢ Face Detection: InsightFace RetinaFace")
    print("â€¢ Face Re-identification: 512D embeddings with cosine similarity")
    print("â€¢ Real-time Visualization: Bounding boxes, IDs, face panels")
    print("â€¢ Performance Monitoring: FPS, statistics, progress")
    print("â€¢ Video Export: Processed video with overlays")
    print("â€¢ CPU Optimized: Designed for CPU-only processing")
    print()

def print_usage_instructions():
    """Print usage instructions"""
    print("ğŸ“– Usage Instructions:")
    print()
    print("1. Install Dependencies:")
    print("   pip install -r requirements.txt")
    print()
    print("2. Prepare Your Video:")
    print("   â€¢ Place your MP4 video in assets/input_video.mp4")
    print("   â€¢ Or update the path in src/config.py")
    print()
    print("3. Run the System:")
    print("   python src/main.py")
    print()
    print("4. Interactive Controls:")
    print("   â€¢ 'q': Quit the application")
    print("   â€¢ 's': Save current frame")
    print("   â€¢ 'c': Clear face recognition cache")
    print()

def print_configuration():
    """Print configuration options"""
    print("âš™ï¸ Configuration Options (src/config.py):")
    print()
    print("Detection & Tracking:")
    print("â€¢ PERSON_CONFIDENCE_THRESHOLD = 0.5")
    print("â€¢ FACE_CONFIDENCE_THRESHOLD = 0.7")
    print("â€¢ TRACKING_ALGORITHM = 'bytetrack'")
    print()
    print("Face Re-identification:")
    print("â€¢ FACE_SIMILARITY_THRESHOLD = 0.7")
    print("â€¢ EMBEDDING_CACHE_SIZE = 1000")
    print()
    print("Performance:")
    print("â€¢ TARGET_FPS = 15")
    print("â€¢ FACE_DETECTION_INTERVAL = 3")
    print("â€¢ MIN_FACE_SIZE = 30")
    print()

def print_technical_details():
    """Print technical implementation details"""
    print("ğŸ”§ Technical Implementation:")
    print()
    print("Pipeline Flow:")
    print("1. Video Input â†’ Frame Extraction")
    print("2. Person Detection â†’ YOLOv8")
    print("3. Person Tracking â†’ ByteTracker")
    print("4. Face Detection â†’ InsightFace (within person boxes)")
    print("5. Face Recognition â†’ 512D embeddings")
    print("6. Re-identification â†’ Cosine similarity matching")
    print("7. Visualization â†’ Bounding boxes, IDs, face panels")
    print("8. Video Output â†’ Processed video with overlays")
    print()
    print("Key Algorithms:")
    print("â€¢ ByteTracker: Handles occlusion, reappearance, ID persistence")
    print("â€¢ Cosine Similarity: Face matching with configurable threshold")
    print("â€¢ FIFO Cache: Memory-efficient embedding storage")
    print("â€¢ Frame Skipping: Performance optimization for face detection")
    print()

def print_output_examples():
    """Print output examples"""
    print("ğŸ“Š Output Examples:")
    print()
    print("Video Output:")
    print("â€¢ assets/output_video.avi - Processed video with overlays")
    print("â€¢ Real-time bounding boxes and IDs")
    print("â€¢ Face panels showing detected faces")
    print("â€¢ Statistics overlay (FPS, counts, etc.)")
    print()
    print("Face Images:")
    print("â€¢ assets/faces/face_1_frame_100.jpg")
    print("â€¢ assets/faces/face_2_frame_150.jpg")
    print("â€¢ Individual face crops for analysis")
    print()
    print("Statistics:")
    print("â€¢ FPS: Current processing speed")
    print("â€¢ People Detected: Number of tracked persons")
    print("â€¢ Faces Detected: Number of detected faces")
    print("â€¢ Unique Faces: Number of distinct face IDs")
    print("â€¢ Embedding Matches: Number of face re-identifications")
    print()

def print_troubleshooting():
    """Print troubleshooting tips"""
    print("ğŸ” Troubleshooting:")
    print()
    print("Low FPS:")
    print("â€¢ Reduce FACE_DETECTION_INTERVAL")
    print("â€¢ Use lower video resolution")
    print("â€¢ Consider GPU acceleration")
    print()
    print("Poor Face Recognition:")
    print("â€¢ Adjust FACE_SIMILARITY_THRESHOLD")
    print("â€¢ Increase MIN_FACE_SIZE")
    print("â€¢ Improve video quality")
    print()
    print("Memory Issues:")
    print("â€¢ Reduce EMBEDDING_CACHE_SIZE")
    print("â€¢ Process shorter video segments")
    print("â€¢ Clear cache periodically ('c' key)")
    print()
    print("Installation Issues:")
    print("â€¢ Run: python test_installation.py")
    print("â€¢ Check Python version (3.8+)")
    print("â€¢ Install missing dependencies")
    print()

def main():
    """Main demo function"""
    print_system_info()
    print_features()
    print_usage_instructions()
    print_configuration()
    print_technical_details()
    print_output_examples()
    print_troubleshooting()
    
    print("=" * 50)
    print("ğŸ‰ System is ready to use!")
    print()
    print("Next steps:")
    print("1. Install dependencies: pip install -r requirements.txt")
    print("2. Test installation: python test_installation.py")
    print("3. Add your video: assets/input_video.mp4")
    print("4. Run the system: python src/main.py")
    print()
    print("For detailed documentation, see README.md")

if __name__ == "__main__":
    main() 